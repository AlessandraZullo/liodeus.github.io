---
layout: post
title: Nibbles
tags: [OSCP, Writeup, Linux, Web, FIle isconfiguration, CMS Exploit]
description: "Nibbles write-up"
---

![Nibbles logo](/assets/imgs/nibbles/nibbles.png)

### This is an easy linux box

## Tools used

------

- browser
- ffuf
- nmap


## Reconnaissance

------

### Nmap

```
nmap -sC -sV -oA nibbles 10.10.10.75 -v

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA)
|   256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA)
|_  256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

Hereâ€™s what nmap teaches us :

- port 22 (SSH) - OpenSSH 7.2p2
- port 80 (HTTP) - Apache 2.4.18

Not a lot of open ports, let's first go to the web port.

![Website - hello world](/assets/imgs/nibbles/website.PNG)

There's not a lot of thing here, so I went up the source code and here's what was in it :

```
<!-- /nibbleblog/ directory. Nothing interesting here! -->
```

Went on it :

![Nibbleblog](/assets/imgs/nibbles/website.PNG)

So this is a blog and we can see at the bottom right that this is "Powered by Nibbleblog". From here I used ffuf to do some files/directories brute force.

```
ffuf -w /home/liodeus/directory-list-lowercase-2.3-medium.txt -u http://10.10.10.75/nibbleblog/FUZZ -e .php,.html,.txt -t 250

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.1.0-git
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.10.75/nibbleblog/FUZZ
 :: Wordlist         : FUZZ: /home/liodeus/directory-list-lowercase-2.3-medium.txt
 :: Extensions       : .php .html .txt 
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 250
 :: Matcher          : Response status: 200,204,301,302,307,401,403
________________________________________________

index.php               [Status: 200, Size: 2985, Words: 116, Lines: 61]
themes                  [Status: 301, Size: 322, Words: 20, Lines: 10]
feed.php                [Status: 200, Size: 302, Words: 8, Lines: 8]
admin                   [Status: 301, Size: 321, Words: 20, Lines: 10]
admin.php               [Status: 200, Size: 1401, Words: 79, Lines: 27]
plugins                 [Status: 301, Size: 323, Words: 20, Lines: 10]
install.php             [Status: 200, Size: 78, Words: 11, Lines: 1]
update.php              [Status: 200, Size: 1621, Words: 103, Lines: 88]
languages               [Status: 301, Size: 325, Words: 20, Lines: 10]
sitemap.php             [Status: 200, Size: 401, Words: 33, Lines: 11]
content                 [Status: 301, Size: 323, Words: 20, Lines: 10]
```

Looking throught those files and directories, I was able to found the version of blog used, a login page and a user :

![Nibbleblog version](/assets/imgs/nibbles/version.PNG)

![Nibbleblog](/assets/imgs/nibbles/login_admin.PNG)

![Nibbleblog](/assets/imgs/nibbles/user.PNG)





## Exploit

------



## Flags

------

### User.txt

```bash
cat user.txt
b02ff32bb332deba49eeaed21152c8d8
```

### Root.txt

```bash
cat root.txt
b6d745c0dfb6457c55591efc898ef88c
```